<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <title>Bug Tracker</title>
</head>
<body>

    <h2>Bug Tracker</h2>

    <table>
        <thead>
            <tr>
                <th class="important-cell">ID</th>
                <th class="important-cell">Title</th>
                <th>Description</th>
                <th>Assigned To</th>
                <th>Priority</th>
            </tr>
        </thead>
        <tbody id="bug-tracker-body">
        </tbody>
    </table>

    <button class="fixed-bug-submission-button" onclick="window.location.href='bug_submission.html'">Add Bug</button>
    <script type="module">
        import init, { fill_table, is_passcode_correct } from "../wasm/servicenow_bug_tracker.js";
        import {cookie_exists, set_cookie, get_cookie} from "../js/cookies.js";
        if (!(typeof WebAssembly === "object" && typeof WebAssembly.instantiate === "function")) {
            window.location.href="../index.html";
        }
        init().then(() => {
            if(cookie_exists("service_now_demo")) {
                const passcode = get_cookie("service_now_demo");
                if (is_passcode_correct(passcode)) {
                    document.body.style.display = "block";
                    fill_table(passcode).then(result => {
                    });
                } else {
                    window.location.href="../index.html";
                }
            } else {
                window.location.href="../index.html";
            }
        });
   </script>
</body>
</html>

